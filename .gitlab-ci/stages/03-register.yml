---

#
.register_stage: &register_stage
  extends: .base_register_stage
  stage: Registration
  except:
    variables:
      - $PRODUCTION
#

Register api image:
  <<: *register_stage
  variables:
    CONTEXT: ./packages/api
    DOCKER_BUILD_ARGS: >-
      --shm-size 256M
    IMAGE_NAME: ${CI_REGISTRY_IMAGE}/api

Register app image:
  <<: *register_stage
  variables:
    CONTEXT: ./packages/app
    DOCKER_BUILD_ARGS: >-
      --shm-size 512M
    IMAGE_NAME: ${CI_REGISTRY_IMAGE}/app

Register init kinto image:
  <<: *register_stage
  variables:
    CONTEXT: packages/kinto
    DOCKERFILE_PATH: packages/kinto/Dockerfile
    IMAGE_NAME: ${CI_REGISTRY_IMAGE}/kinto

...
